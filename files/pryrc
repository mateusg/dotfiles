Pry.config.editor = ENV.fetch("EDITOR", "subl -n -w")

Pry.config.prompt = proc do |object, level, pry|
  prompt = "#{RUBY_VERSION}"
  prompt << "::#{Rails.version}" if defined?(Rails)
  "#{prompt} (#{object})> "
end

Pry.config.exception_handler = proc do |output, exception, pry|
  output.puts Pry::Helpers::Text.red("#{exception.class}: #{exception.message}\n from #{exception.backtrace.first}")
end

if defined?(Rails)
  require "rails/console/app"
  require "rails/console/helpers"
  TOPLEVEL_BINDING.eval("self").extend ::Rails::ConsoleMethods
end

begin
  require "awesome_print"

  # Uses awesome_print output style with pry
  # AwesomePrint.pry! if defined?(AwesomePrint)

  # Uses awesome_print output and also paginates results with pry pager
  Pry.config.print = proc { |output, value| Pry::Helpers::BaseHelpers.stagger_output("=> #{value.ai}", output) }
rescue LoadError => err
  warn "=> Unable to load awesome_print"
end
